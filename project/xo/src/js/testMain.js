!function(e){function t(){P=e.datalist,F=e.fimglist,B=e.loadData,q=-parseInt((1040*ysStage.wScale-ysStage.windowHeight)/ysStage.wScale),q>0&&(q=0);var t=1040/ysStage.hwScale;t>700?t=700:640>t&&(t=640),k=new LSprite,addChild(k);for(var n=0;n<K.length;n++)X(K[n]),Q[K[n]].visible=!1;w(),_(),p(),Q.user.x=-30,c(),a(),R=new N,Z=-1!=K.indexOf(R.page)?R.page:"home",Q[Z].visible=!0,Y()}function a(){for(var e in J)"btn"==e.slice(e.length-3)&&J[e].addEventListener(LMouseEvent.MOUSE_DOWN,n);Q.share.addEventListener(LMouseEvent.MOUSE_DOWN,n)}function n(e){if(0==ve){var t=e.currentTarget.name;if("share"==t)return void O("share");LTweenLite.to(e.currentTarget,.1,{scaleX:.9,scaleY:.9}).to(e.currentTarget,.1,{scaleX:1,scaleY:1}),0==ee&&(ee=!0,setTimeout(i,300,t))}}function i(t){ee=!1,"home_playbtn"==t?(I("game"),s()):"home_rulebtn"==t?S("rule","B"):"home_userbtn"==t?(T(),S("user","T")):"rule_closebtn"==t?O("rule","B"):"rule_playbtn"==t?(I("game"),s()):"gameover_userbtn"==t?(T(),S("user","T")):"gameover_sharebtn"==t?S("share"):"gameover_expbtn"==t?e.showInputPage():"gameover_playbtn"==t?(O("gameover"),o()):"gameover_nextbtn"==t?(O("gameover"),g()):"user_backbtn"==t&&O("user")}function s(){var e=new LSprite;e.x=-110,e.y=-32,J.game_lvTxtSp=e,J.game_info.addChild(e);var t=new LTextField;t.size=55,t.color="#ffffff",t.stroke=!0,t.lineWidth=8,t.lineColor="#3C848F",t.x=0,t.y=0,t.text="1",t.textAlign="center",J.game_lvTxt=t,e.addChild(t);var a=new LTextField;a.size=55,a.color="#ffffff",a.stroke=!0,a.lineWidth=8,a.lineColor="#3C848F",a.x=180,a.y=-32,a.text="20'",a.textAlign="center",J.game_timeTxt=a,J.game_info.addChild(a);for(var n=["game_n1","game_n2","game_n3","game_go","game_timeout"],i=0;5>i;i++)J[n[i]].alpha=0,J[n[i]].x=320,J[n[i]].y=500;var s=new LTextField;s.size=40,s.color="#ff8208",s.stroke=!0,s.lineWidth=4,s.lineColor="#9c3700",s.x=J.game_sun.x-6,s.y=850,s.text="6",s.textAlign="center",J.game_sSpNumTxt=s,Q.game.addChild(s),G=new LSprite,G.x=J.game_sun.x-6,G.y=J.game_sun.y-8,Q.game.addChild(G),H=new LSprite,H.x=J.game_sun.x-6,H.y=950,Q.game.addChild(H);var l=J.game_y0;l.addEventListener(LEvent.ENTER_FRAME,r),te.isGamePlaying=!1,o(),j=J.game_p0,Q.game.addEventListener(LMouseEvent.MOUSE_DOWN,v)}function r(){for(var e=0;4>e;e++)J["game_y"+e].x<-640?J["game_y"+e].x=640+J["game_y"+e].getWidth()/2:J["game_y"+e].x-=2}function o(){0==te.isGamePlaying&&(te.isGamePlaying=!0,e.gameStart(),te.time=400,J.game_timeTxt.text=parseInt(te.time/20)+"'",J.game_lvTxt.text=se,J.game_go.alpha=0,J.game_go.scaleX=1.5,J.game_go.scaleY=1.5,J.game_go.visible=!0,LTweenLite.to(J.game_go,.5,{alpha:1,scaleX:1,scaleY:1,delay:.5,ease:LEasing.Strong.easeOut}).to(J.game_go,.5,{alpha:0,scaleX:1.5,scaleY:1.5,delay:.5,ease:LEasing.Strong.easeOut}).to(J.game_go,0,{visible:!1,onComplete:m}),l())}function l(){ae=[];for(var e=0;7>e;e++)ae[e]=60*e;ne=[],H.removeAllChild(),G.removeAllChild(),G.rotate=0;for(var e=0;6>e;e++){var t=A("game_l",!0);t.x=250*Math.cos(60*e*Math.PI/180),t.y=250*Math.sin(60*e*Math.PI/180),t.rotate=90+60*e,G.addChild(t)}ie=5+se;for(var e=0;ie>e;e++){var a=parseInt(5*Math.random()),n=A("game_s"+a,!0);n.x=50*e,n.type=a,H.addChild(n),ne.push(n)}J.game_sSpNumTxt.text=ne.length,te.time=600,te.lvNum=se,J.game_lvTxt.text=se,U=1+se/10*2,console.log("speedNum:"+U),J.game_timeTxt.text=parseInt(te.time/30)+"'"}function g(){se++,o()}function m(){re=!0,Q.game.addEventListener(LEvent.ENTER_FRAME,d)}function v(e){if(1==re){J.game_p1.visible=!0,J.game_p0.visible=!1,LTweenLite.to(J.game_p0,0,{visible:!0,delay:.2}).to(J.game_p1,0,{visible:!1});var t=ne[0];LTweenLite.to(t,.1,{y:-250}).to(t,0,{alpha:0,onComplete:u}),ne.remove(ne[0]),J.game_sSpNumTxt.text=ne.length;for(var a=0;a<ne.length;a++)ne[a].x=50*a}}function u(e){var t=e.target.type,a=parseInt(-G.rotate+90+360)%360,n=A("game_s"+t,!0);n.x=220*Math.cos(a*Math.PI/180),n.y=220*Math.sin(a*Math.PI/180),n.rotate=-90+a,G.addChild(n),console.log(G.rotate+" / "+a+" / "+ae);for(var i=0;i<ae.length;i++)if(Math.abs(a-ae[i])<12)return n.scaleX=.7,n.scaleY=.7,LTweenLite.to(n,.8,{scaleX:1.2,scaleY:1.2,ease:LEasing.Elastic.easeOut,delay:.1}),void L(0);ae.push(a),0==ne.length&&L(1)}function d(e){J.game_timeTxt.text=parseInt(te.time/30)+"'",0==te.time&&L(0),G.rotate+=U,G.rotate>360&&(G.rotate=G.rotate-360)}function L(e){1==re&&(oe=e,te.isGamePlaying=!1,re=!1,Q.game.removeEventListener(LEvent.ENTER_FRAME,d),setTimeout(h,500))}function c(){var e=new LTextField;e.size=42,e.color="#623f05",e.text="快来领大奖！",e.x=-220,e.y=-130,e.width=450,e.setWordWrap(!0,60),J.gameover_msgTxt=e,J.gameover_tbg.addChild(e)}function h(){e.userData.passLvNum=se-1;var t=new Object;t.passLvNum=se-1,e.gameOver(t),0==oe?(J.gameover_expbtn.visible=!0,J.gameover_playbtn.visible=!0,J.gameover_nextbtn.visible=!1,se>10?J.gameover_msgTxt.text="恭喜你，你糊了太阳"+se+"轮，打败了98%的小伙伴，将高温尽数驱逐！":se>8?J.gameover_msgTxt.text="太棒了，太阳被你糊了"+se+"轮，打败了60%的小伙伴，重返常温不是梦！":se>5?J.gameover_msgTxt.text="哎哟不错哦，你糊了太阳"+se+"轮，打败了34%的小伙伴，再加把劲哦！":(J.gameover_expbtn.visible=!1,J.gameover_msgTxt.text="4.很遗憾，你才打败了9%的小伙伴，差一点点就能把高温降下来了呢......")):(J.gameover_msgTxt.text="恭喜你，第"+se+"关成功通关，马上下一关吧！",J.gameover_nextbtn.visible=!0,J.gameover_expbtn.visible=!1,J.gameover_playbtn.visible=!1),S("gameover");var a=J.gameover_bg;a.alpha=0,LTweenLite.to(a,.3,{alpha:.8});var a=J.gameover_tbg;a.alpha=0,a.scaleX=.2,a.scaleY=.2,LTweenLite.to(a,.5,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Sine.easeOut});for(var n=["gameover_playbtn","gameover_sharebtn","gameover_expbtn","gameover_userbtn","gameover_nextbtn"],i=0;i<n.length;i++){var a=J[n[i]];a.alpha=0,a.scaleX=.2,a.scaleY=.2,LTweenLite.to(a,.5,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Back.easeOut,delay:.3+.1*i})}}function p(){var e=new LTextField;e.size=42,e.color="#623f05",e.text="快来领大奖！",e.x=-200,e.y=-100,e.width=400,e.setWordWrap(!0,60),J.tip_msgTxt=e,J.tip_tbg.addChild(e),Q.tip.addEventListener(LMouseEvent.MOUSE_DOWN,x)}function x(e){O("tip")}function f(e){J.tip_msgTxt.text=e,S("tip");var t=J.tip_tbg;t.alpha=0,t.scaleX=.2,t.scaleY=.2,LTweenLite.to(t,.3,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Back.easeOut})}function _(){var t=new LLoader;t.addEventListener(LEvent.COMPLETE,b),t.load(e.userData.hpic,"bitmapData");var a=new LTextField;a.size=36,a.color="#ffffff",a.text=e.userData.name,a.x=350,a.y=160,J.user_nameTxt=a,Q.user.addChild(a);var n=new LTextField;n.size=80,n.color="#ffffff",n.text="0",n.x=500,n.y=210,J.user_stampTxt=n,Q.user.addChild(n);var i=new LSprite;i.x=129,i.y=481,J.user_iList=i,Q.user.addChild(i);for(var s=0;9>s;s++){var r=A("user_i",!0);r.x=s%3*168+54,r.y=138*(s/3>>0)+54,r.id=s,ue[s]=r,i.addChild(r),r.addEventListener(LMouseEvent.MOUSE_DOWN,y)}T()}function y(t,a){LTweenLite.to(t.currentTarget,.1,{scaleX:.8,scaleY:.8}).to(t.currentTarget,.1,{scaleX:1,scaleY:1});var n=e.getPrizeData(a.id),i="很遗憾，您在本期游戏中没有获奖哦~请加油！";0==e.userData.isPlayArr[a.id]?i="你还没有玩过这个游戏呢！":-1==e.userData.isPlayArr[a.id]?i="这个游戏还没上线呢！":1==n.isLucky&&(i=n.tel+"\n在【"+n.gameName+"】中\n获得 "+n.prize),f(i)}function T(){me=0;for(var t=0;9>t;t++)if(e.userData.isPlayArr[t]>-1){var a=0,n=107*t;1==e.userData.isPlayArr[t]&&(me++,a=107);var i=new LBitmapData(P.user_ipic,a,n,107,107,LBitmapData.DATA_CANVAS);ue[t].bitmap.bitmapData=i}J.user_stampTxt.text=me}function b(e){var t=new LBitmapData(e.target),a=new LBitmap(t);a.scaleX=a.scaleY=240/a.getWidth(),a.x=-120,a.y=-120;var n=new LSprite;n.addChild(a),n.x=205,n.y=176,Q.user.addChild(n);var i=new LSprite;i.graphics.drawArc(0,"",[0,0,118,0,180*Math.PI*2],!0,"#ffffff"),i.x=n.x,i.y=n.y,n.mask=i}function E(e){J.gameover_msgTxt.text="恭喜你 "+e.tel+"\n获得 "+e.prize,J.gameover_expbtn.visible=!1}function w(){var e=J.home_bg;e.alpha=0,LTweenLite.to(e,.5,{alpha:1});for(var t=0;3>t;t++){var e=J["home_t"+t];e.scaleX=.2,e.scaleY=.2,e.alpha=0,LTweenLite.to(e,1.5,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Elastic.easeOut,delay:1.5+.2*t}).to(e,.3,{scaleX:1.1,scaleY:1.1,loop:!0}).to(e,.3,{scaleX:1,scaleY:1})}for(var a=["home_playbtn","home_rulebtn","home_userbtn"],t=0;3>t;t++){var e=J[a[t]];e.scaleX=.2,e.scaleY=.2,e.alpha=0,LTweenLite.to(e,1.5,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Elastic.easeOut,delay:2+.3*t})}var e=J.home_p;e.scaleX=.2,e.scaleY=.2,e.alpha=0,LTweenLite.to(e,2,{alpha:1,scaleX:1,scaleY:1,ease:LEasing.Elastic.easeOut,delay:.3})}function S(e,t,a){Q[e].direction=t,"R"==t?(Q[e].x=le,LTweenLite.to(Q[e],1,{x:0,ease:LEasing.Strong.easeInOut})):"L"==t?(Q[e].x=-le,LTweenLite.to(Q[e],1,{x:0,ease:LEasing.Strong.easeInOut})):"T"==t?(Q[e].y=-ge,LTweenLite.to(Q[e],1,{y:0,ease:LEasing.Strong.easeInOut})):"B"==t?(Q[e].y=ge,LTweenLite.to(Q[e],1,{y:0,ease:LEasing.Strong.easeInOut})):"A"==t?(Q[e].x=0,Q[e].y=0,Q[e].alpha=0,LTweenLite.to(Q[e],.5,{alpha:1})):(Q[e].x=0,Q[e].y=0),Q[e].visible=!0,k.setChildIndex(Q[e],k.numChildren-1),a&&setTimeout(a,1e3)}function O(e){var t=Q[e].direction,a=1e3;"R"==t?LTweenLite.to(Q[e],.7,{x:le,ease:LEasing.Strong.easeInOut}):"L"==t?LTweenLite.to(Q[e],.7,{x:-le,ease:LEasing.Strong.easeInOut}):"T"==t?LTweenLite.to(Q[e],.7,{y:-ge,ease:LEasing.Strong.easeInOut}):"B"==t?LTweenLite.to(Q[e],.7,{y:ge,ease:LEasing.Strong.easeInOut}):"A"==t?LTweenLite.to(Q[e],.3,{alpha:0}):a=1,setTimeout(C,a,e)}function C(e){Q[e].visible=!1,k.setChildIndex(Q[e],0)}function I(e,t,a){Z!=e&&(Q[e].x=0,Q[e].y=0,"R"==t?(Q[e].x=le,LTweenLite.to(Q[Z],1,{x:-le,ease:LEasing.Strong.easeInOut}),LTweenLite.to(Q[e],1,{x:0,ease:LEasing.Strong.easeInOut})):"L"==t?(Q[e].x=-le,LTweenLite.to(Q[Z],1,{x:le,ease:LEasing.Strong.easeInOut}),LTweenLite.to(Q[e],1,{x:0,ease:LEasing.Strong.easeInOut})):"T"==t?(Q[e].y=-ge,LTweenLite.to(Q[Z],1,{y:ge,ease:LEasing.Strong.easeInOut}),LTweenLite.to(Q[e],1,{y:0,ease:LEasing.Strong.easeInOut})):(Q[e].y=ge,LTweenLite.to(Q[Z],1,{y:-ge,ease:LEasing.Strong.easeInOut}),LTweenLite.to(Q[e],1,{y:0,ease:LEasing.Strong.easeInOut})),Q[e].visible=!0,$=Z,Z=e,setTimeout(M,1e3,$),setTimeout(a,1e3))}function M(e){Q[e].visible=!1}function X(e){var t=new LSprite;t.name=e;for(var a=0;a<B.length;a++)if(B[a].parent==e){var n=new A(B[a].name,!0);n.x=n.initX,n.y=n.initY,t.addChild(n)}Q[e]=t,k.addChild(t)}function Y(){function t(e){n.play(),LGlobal.stage.removeEventListener(LMouseEvent.MOUSE_DOWN,t)}z=A("soundIcon",!0);var a=A("soundIconae",!0);z.addChild(a),z.ae=a,z.ae.visible=!1,z.x=600,z.y=40,z.addEventListener(LMouseEvent.MOUSE_DOWN,D),addChild(z),z.tween=LTweenLite.to(z,2,{rotate:360,loop:!0}).to(z,0,{rotate:0});var n=e.document.getElementById("bgMusic");n.paused&&LGlobal.stage.addEventListener(LMouseEvent.MOUSE_DOWN,t)}function D(t){var a=e.document.getElementById("bgMusic");a.paused?(a.play(),z.alpha=1,z.tween.resume(),z.ae.visible=!1):(a.pause(),z.ae.visible=!0,z.alpha=.5,z.tween.pause())}function A(e,t){var a=new LBitmapData(P[e]),n=new LBitmap(a),i=new LSprite;1==t&&(n.x=-n.getWidth()/2,n.y=-n.getHeight()/2),i.bitmap=n,i.bitmapdata=a,i.addChild(n);var s;for(s=0;s<B.length;s++)if(e==B[s].name){1==t?(i.initX=B[s].x+n.getWidth()/2,i.initY=B[s].y+n.getHeight()/2):(i.initX=B[s].x,i.initY=B[s].y);break}return V[e+"Sp"]=i,i.name=e,J[e]=i,i}function N(){var e,t,a=location.href,n=a.indexOf("?");this.rootUrl=a.substr(0,n),a=a.substr(n+1);for(var i=a.split("&"),s=0;s<i.length;s++)n=i[s].indexOf("="),n>0&&(e=i[s].substring(0,n),t=i[s].substr(n+1),this[e]=t)}var W={init:t,showInputed:E};e.main=W;var P,B,F,z,k,R,U,G,H,j,V=[],q=0,J=[],K=["home","game","user","rule","gameover","share","tip"],Q=[],Z="home",$="",ee=!1,te=[],ae=[],ne=[],ie=6,se=1,re=!1,oe=0,le=700,ge=1040,me=0,ve=!1,ue=[];Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++)if(this[t]==e)return t;return-1},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)}}(window);